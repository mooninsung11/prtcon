import pandas as pd
from tkinter import Tk
<<<<<<< HEAD
from tkinter.filedialog import askopenfilenames
import pymysql
import os

def main():
    # 1. ì—¬ëŸ¬ íŒŒì¼ ì„ íƒì°½ ë„ìš°ê¸°
    root = Tk()
    root.withdraw()
    file_paths = askopenfilenames(
        title="CSV íŒŒì¼ì„ ëª¨ë‘ ì„ íƒí•˜ì„¸ìš” (Ctrl ë˜ëŠ” Shiftë¡œ ë‹¤ì¤‘ ì„ íƒ)",
        filetypes=[("CSV files", "*.csv")]
    )
    root.destroy()
    if not file_paths:
        print("íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
        return

    # 2. MySQL ì—°ê²°
    conn = pymysql.connect(
        host='localhost',
        user='root',
        password='dbsgusqja1',
        db='test',
        charset='utf8'
    )
    cursor = conn.cursor()

    sql = """
    INSERT INTO Product (name, price, image_url, category)
    VALUES (%s, %s, %s, %s)
    """

    total = 0
    for file_path in file_paths:
        df = pd.read_csv(file_path)
        print(f"\nðŸ“‚ ì„ íƒí•œ íŒŒì¼: {file_path}")
        print(df.head())
        print(df.columns)

        df = df.where(pd.notnull(df), None)
        category = os.path.splitext(os.path.basename(file_path))[0]
        count = 0

        for _, row in df.iterrows():
            price_val = row['price']
            if isinstance(price_val, str):
                price_val = price_val.replace(',', '').replace('ì›', '').strip()
                price_val = float(price_val) if price_val else None

            cursor.execute(sql, (
                row.get('name', None),
                price_val,
                row.get('image_url', None),
                category
            ))
            count += 1
            total += 1

        print(f"âœ… '{category}'ì—ì„œ {count}ê°œ ì‚½ìž… ì™„ë£Œ.")

        conn.commit()
    cursor.close() 
    conn.close()
    print(f"\nðŸ”¥ ëª¨ë“  íŒŒì¼ í•©ì³ì„œ ì´ {total}ê°œ ë°ì´í„°ë¥¼ Product í…Œì´ë¸”ì— ì‚½ìž…í–ˆìŠµë‹ˆë‹¤.")

=======
from tkinter.filedialog import askopenfilename
from prophet import Prophet
import matplotlib.pyplot as plt

# 1. íŒŒì¼ ë‹¤ì´ì–¼ë¡œê·¸ë¡œ CSV íŒŒì¼ ì„ íƒ
root = Tk()
root.withdraw()
file_path = askopenfilename(
    title="CSV íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”",
    filetypes=[("CSV files", "*.csv")]
)
root.destroy()

if not file_path:
    print("íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
else:
    # 2. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    df = pd.read_csv(file_path)

    # 3. Prophet ìž…ë ¥ í¬ë§·ìœ¼ë¡œ ë³€í™˜ (USO_Close ì˜ˆì¸¡)
    df = df[['Date', 'USO_Close']].rename(columns={'Date': 'ds', 'USO_Close': 'y'})
    df['ds'] = pd.to_datetime(df['ds'])
    df['y'] = df['y'].interpolate()  # ê²°ì¸¡ì¹˜ ì„ í˜• ë³´ê°„

    # 4. Prophet ëª¨ë¸ ìƒì„± ë° í•™ìŠµ
    m = Prophet()
    m.fit(df)

    # 5. ë¯¸ëž˜ 90ì¼ ì˜ˆì¸¡
    future = m.make_future_dataframe(periods=90)
    forecast = m.predict(future)

    # 6. ê²°ê³¼ ì‹œê°í™”
    fig1 = m.plot(forecast)
    plt.title('USO Time Series of Closing Price (Prophet)')
    plt.xlabel('time')
    plt.ylabel('USO Closing Price')
    plt.show()

    fig2 = m.plot_components(forecast)
    plt.show()
>>>>>>> 8eaa13f (ìˆ˜ì •ë³¸)
